{% extends 'exams/base.html' %}

{% block content %}
<div class="container mt-5">
    <div class="text-center mb-4">
        <h2>{{ exam.name }} Results</h2>
        <p><strong>Date Taken:</strong> {{ timestamp|date:"M d, Y h:i A" }}</p>
        <p><strong>Time Spent:</strong> {{ time_taken }}</p>
        <p><strong>Score:</strong> {{ score }} / 900</p>
        <p>
            <strong>Result:</strong>
            {% if passed %}
                <span class="text-success fw-bold">Passed</span>
            {% else %}
                <span class="text-danger fw-bold">Failed</span>
            {% endif %}
        </p>
    </div>

    {% if feedback %}
    <div class="card shadow">
        <div class="card-body">
            <h5 class="card-title">Feedback on Incorrect Answers</h5>
            <ul class="list-group list-group-flush">
                {% for question_text, info in feedback.items %}
                    <li class="list-group-item">
                        <strong>Question:</strong> {{ question_text }}<br>

                        <strong>Your Answer:</strong>
                        {% if info.your_answer.items %}
                            <ul class="mb-2">
                                {% for k, v in info.your_answer.items %}
                                    <li>{{ k }} → {{ v }}</li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            {{ info.your_answer }}
                        {% endif %}

                        <strong>Correct Answer:</strong>
                        {% if info.correct_answer.items %}
                            <ul>
                                {% for k, v in info.correct_answer.items %}
                                    <li>{{ k }} → {{ v }}</li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            {{ info.correct_answer }}
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}




    <div class="text-center mt-4">
        <a href="{% url 'dashboard' %}" class="btn btn-primary">Back to Dashboard</a>
        <a href="{% url 'exam_list' %}" class="btn btn-outline-secondary">Try Another Exam</a>
    </div>
</div>
{% endblock %}
